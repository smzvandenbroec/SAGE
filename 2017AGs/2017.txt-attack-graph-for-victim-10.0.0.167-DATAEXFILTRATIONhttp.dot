digraph DATAEXFILTRATIONhttp {
rankdir="BT"; 
 graph [ nodesep="0.1", ranksep="0.02"] 
 node [ fontname=Arial, fontsize=24,penwidth=3]; 
 edge [ fontname=Arial, fontsize=20,penwidth=5 ];
"Victim: 10.0.0.167
DATA EXFILTRATION
http" [shape=doubleoctagon, style=filled, fillcolor=salmon];
{ rank = max; "Victim: 10.0.0.167
DATA EXFILTRATION
http"}
"DATA EXFILTRATION
http | ID: 26" -> "Victim: 10.0.0.167
DATA EXFILTRATION
http"
"DATA EXFILTRATION
http | ID: 26" [style=filled, fillcolor= salmon]
{ rank=same; "DATA EXFILTRATION
http | ID: 26"}
"VULNERABILTY DISCOVERY
postgresql" [style=filled, fillcolor= yellow]
"VULNERABILTY DISCOVERY
postgresql" -> "SERVICE DISCOVERY
ssh" [ color=blue] [label=<<font color="blue"> start_next: 04/11/17, 13:34:49<br/>gap: 859sec<br/>end_prev: 04/11/17, 13:20:30</font><br/><font color="blue"><b>Attacker: 10.0.254.31</b></font>>]
"SERVICE DISCOVERY
ssh" -> "VULNERABILTY DISCOVERY
ms-sql-s" [ label="start_next: 04/11/17, 14:01:06
gap: 1578sec
end_prev: 04/11/17, 13:34:49"][ fontcolor="blue" color=blue]
"VULNERABILTY DISCOVERY
ms-sql-s" -> "ARBITRARY CODE EXECUTION
ssdp | ID: 355" [ label="start_next: 04/11/17, 14:03:08
gap: 51sec
end_prev: 04/11/17, 14:02:17"][ fontcolor="blue" color=blue]
"ARBITRARY CODE EXECUTION
ssdp | ID: 355" -> "REMOTE SERVICE EXPLOIT
snmp | ID: 52" [ label="start_next: 04/11/17, 14:03:40
gap: 22sec
end_prev: 04/11/17, 14:03:18"][ fontcolor="blue" color=blue]
"REMOTE SERVICE EXPLOIT
snmp | ID: 52" -> "INFO DISCOVERY
xdmcp" [ label="start_next: 04/11/17, 14:03:41
gap: 1sec
end_prev: 04/11/17, 14:03:40"][ fontcolor="blue" color=blue]
"INFO DISCOVERY
xdmcp" -> "ACCOUNT MANIPULATION
snmp | ID: 53" [ label="start_next: 04/11/17, 14:04:35
gap: -59sec
end_prev: 04/11/17, 14:05:34"][ fontcolor="blue" color=blue]
"ACCOUNT MANIPULATION
snmp | ID: 53" -> "DATA DELIVERY
http | ID: 246" [ label="start_next: 04/11/17, 14:05:37
gap: 33sec
end_prev: 04/11/17, 14:05:04"][ fontcolor="blue" color=blue]
"DATA DELIVERY
http | ID: 246" -> "DATA EXFILTRATION
http | ID: 26" [ label="start_next: 04/11/17, 14:05:39
gap: 2sec
end_prev: 04/11/17, 14:05:37"][ fontcolor="blue" color=blue]
"SERVICE DISCOVERY
spt-automation" [style=filled, fillcolor= yellow]
"SERVICE DISCOVERY
spt-automation" -> "VULNERABILTY DISCOVERY
ms-sql-s" [ color=blue] [label=<<font color="blue"> start_next: 04/11/17, 16:29:55<br/>gap: -30sec<br/>end_prev: 04/11/17, 16:30:24</font><br/><font color="blue"><b>Attacker: 10.0.254.31</b></font>>]
"VULNERABILTY DISCOVERY
ms-sql-s" -> "ARBITRARY CODE EXECUTION
ssdp | ID: 355" [ label="start_next: 04/11/17, 16:31:31
gap: -116sec
end_prev: 04/11/17, 16:33:27"][ fontcolor="blue" color=blue]
"ARBITRARY CODE EXECUTION
ssdp | ID: 355" -> "REMOTE SERVICE EXPLOIT
snmp | ID: 52" [ label="start_next: 04/11/17, 16:32:03
gap: 22sec
end_prev: 04/11/17, 16:31:41"][ fontcolor="blue" color=blue]
"REMOTE SERVICE EXPLOIT
snmp | ID: 52" -> "INFO DISCOVERY
xdmcp" [ label="start_next: 04/11/17, 16:32:05
gap: 2sec
end_prev: 04/11/17, 16:32:03"][ fontcolor="blue" color=blue]
"INFO DISCOVERY
xdmcp" -> "ACCOUNT MANIPULATION
snmp | ID: 53" [ label="start_next: 04/11/17, 16:33:04
gap: -25sec
end_prev: 04/11/17, 16:33:28"][ fontcolor="blue" color=blue]
"ACCOUNT MANIPULATION
snmp | ID: 53" -> "DATA DELIVERY
http | ID: 246" [ label="start_next: 04/11/17, 16:33:31
gap: 15sec
end_prev: 04/11/17, 16:33:16"][ fontcolor="blue" color=blue]
"DATA DELIVERY
http | ID: 246" -> "DATA EXFILTRATION
http | ID: 26" [ label="start_next: 04/11/17, 16:33:38
gap: 7sec
end_prev: 04/11/17, 16:33:31"][ fontcolor="blue" color=blue]
"VULNERABILTY DISCOVERY
ms-sql-s" [style=filled, fillcolor= yellow]
"VULNERABILTY DISCOVERY
ms-sql-s" -> "SERVICE DISCOVERY
unknown" [ color=blue] [label=<<font color="blue"> start_next: 04/11/17, 18:01:39<br/>gap: 40sec<br/>end_prev: 04/11/17, 18:00:59</font><br/><font color="blue"><b>Attacker: 10.0.254.31</b></font>>]
"SERVICE DISCOVERY
unknown" -> "NETWORK DoS
ssdp | ID: 55" [ label="start_next: 04/11/17, 18:02:30
gap: -57sec
end_prev: 04/11/17, 18:03:27"][ fontcolor="blue" color=blue]
"NETWORK DoS
ssdp | ID: 55" -> "INFO DISCOVERY
xdmcp" [ label="start_next: 04/11/17, 18:03:14
gap: 45sec
end_prev: 04/11/17, 18:02:30"][ fontcolor="blue" color=blue]
"INFO DISCOVERY
xdmcp" -> "ACCOUNT MANIPULATION
snmp | ID: 53" [ label="start_next: 04/11/17, 18:04:03
gap: 46sec
end_prev: 04/11/17, 18:03:18"][ fontcolor="blue" color=blue]
"ACCOUNT MANIPULATION
snmp | ID: 53" -> "DATA DELIVERY
http | ID: 246" [ label="start_next: 04/11/17, 18:04:41
gap: 30sec
end_prev: 04/11/17, 18:04:11"][ fontcolor="blue" color=blue]
"DATA DELIVERY
http | ID: 246" -> "DATA EXFILTRATION
http | ID: 26" [ label="start_next: 04/11/17, 18:04:44
gap: 3sec
end_prev: 04/11/17, 18:04:41"][ fontcolor="blue" color=blue]
"SURFING
http" [style=filled, fillcolor= yellow]
"SURFING
http" -> "INFO DISCOVERY
http" [ color=purple] [label=<<font color="purple"> start_next: 04/11/17, 13:40:40<br/>gap: -11sec<br/>end_prev: 04/11/17, 13:40:51</font><br/><font color="purple"><b>Attacker: 10.0.254.30</b></font>>]
"INFO DISCOVERY
http" -> "DATA EXFILTRATION
http | ID: 26" [ label="start_next: 04/11/17, 13:40:41
gap: 1sec
end_prev: 04/11/17, 13:40:40"][ fontcolor="purple" color=purple]
"SURFING
http" [style=filled, fillcolor= yellow]
"SURFING
http" -> "INFO DISCOVERY
http" [ color=tomato] [label=<<font color="tomato"> start_next: 04/11/17, 13:41:51<br/>gap: -9sec<br/>end_prev: 04/11/17, 13:42:00</font><br/><font color="tomato"><b>Attacker: 10.0.254.33</b></font>>]
"INFO DISCOVERY
http" -> "DATA EXFILTRATION
http | ID: 26" [ label="start_next: 04/11/17, 13:41:52
gap: 1sec
end_prev: 04/11/17, 13:41:51"][ fontcolor="tomato" color=tomato]
"HOST DISCOVERY
ms-wbt-server" [style=filled, fillcolor= yellow]
"HOST DISCOVERY
ms-wbt-server" -> "SERVICE DISCOVERY
rpas-c2" [ color=turquoise] [label=<<font color="turquoise"> start_next: 04/11/17, 12:50:31<br/>gap: 167sec<br/>end_prev: 04/11/17, 12:47:45</font><br/><font color="turquoise"><b>Attacker: 10.0.254.30</b></font>>]
"SERVICE DISCOVERY
rpas-c2" -> "HOST DISCOVERY
http" [ label="start_next: 04/11/17, 12:55:58
gap: -325sec
end_prev: 04/11/17, 13:01:23"][ fontcolor="turquoise" color=turquoise]
"HOST DISCOVERY
http" -> "ARBITRARY CODE EXECUTION
http | ID: 32" [ label="start_next: 04/11/17, 12:56:09
gap: 11sec
end_prev: 04/11/17, 12:55:58"][ fontcolor="turquoise" color=turquoise]
"ARBITRARY CODE EXECUTION
http | ID: 32" -> "INFO DISCOVERY
http" [ label="start_next: 04/11/17, 12:56:14
gap: 5sec
end_prev: 04/11/17, 12:56:09"][ fontcolor="turquoise" color=turquoise]
"INFO DISCOVERY
http" -> "SURFING
http" [ label="start_next: 04/11/17, 12:56:15
gap: 1sec
end_prev: 04/11/17, 12:56:14"][ fontcolor="turquoise" color=turquoise]
"SURFING
http" -> "DATA EXFILTRATION
http | ID: 26" [ label="start_next: 04/11/17, 12:56:16
gap: -8sec
end_prev: 04/11/17, 12:56:24"][ fontcolor="turquoise" color=turquoise]
"VULNERABILTY DISCOVERY
postgresql" [shape=oval]
"VULNERABILTY DISCOVERY
postgresql" [tooltip="ET POLICY Suspicious inbound to Oracle SQL port 1521
ET POLICY Suspicious inbound to PostgreSQL port 5432"]
"SERVICE DISCOVERY
ssh" [shape=oval]
"SERVICE DISCOVERY
ssh" [tooltip="ET SCAN Potential SSH Scan"]
"VULNERABILTY DISCOVERY
ms-sql-s" [shape=oval]
"VULNERABILTY DISCOVERY
ms-sql-s" [tooltip="ET POLICY Suspicious inbound to mySQL port 3306
ET POLICY Suspicious inbound to mSQL port 4333
ET POLICY Suspicious inbound to MSSQL port 1433
ET POLICY Suspicious inbound to Oracle SQL port 1521
ET SCAN Nessus User Agent
ET POLICY Suspicious inbound to PostgreSQL port 5432"]
"ARBITRARY CODE EXECUTION
ssdp | ID: 355" [shape=box]
"ARBITRARY CODE EXECUTION
ssdp | ID: 355" [tooltip="GPL MISC UPnP malformed advertisement"]
"REMOTE SERVICE EXPLOIT
snmp | ID: 52" [shape=box]
"REMOTE SERVICE EXPLOIT
snmp | ID: 52" [tooltip="ET SNMP Samsung Printer SNMP Hardcode RW Community String"]
"INFO DISCOVERY
xdmcp" [shape=oval]
"INFO DISCOVERY
xdmcp" [tooltip="GPL WEB_SERVER mod_gzip_status access
GPL RPC xdmcp info query"]
"ACCOUNT MANIPULATION
snmp | ID: 53" [shape=box]
"ACCOUNT MANIPULATION
snmp | ID: 53" [tooltip="GPL SNMP private access udp
GPL SNMP public access udp"]
"DATA DELIVERY
http | ID: 246" [shape=hexagon]
"DATA DELIVERY
http | ID: 246" [tooltip="GPL WEB_SERVER perl post attempt"]
"DATA EXFILTRATION
http | ID: 26" [shape=hexagon]
"DATA EXFILTRATION
http | ID: 26" [tooltip="ET WEB_SPECIFIC_APPS PHP-CGI query string parameter vulnerability"]
"SERVICE DISCOVERY
spt-automation" [shape=oval]
"SERVICE DISCOVERY
spt-automation" [tooltip="ET SCAN Potential VNC Scan 5800-5820
ET SCAN Potential SSH Scan"]
"SERVICE DISCOVERY
unknown" [shape=oval]
"SERVICE DISCOVERY
unknown" [tooltip="ET SCAN Potential SSH Scan
ET SCAN Potential VNC Scan 5900-5920"]
"NETWORK DoS
ssdp | ID: 55" [shape=hexagon]
"NETWORK DoS
ssdp | ID: 55" [tooltip="ET DOS Possible SSDP Amplification Scan in Progress"]
"SURFING
http" [shape=oval]
"SURFING
http" [tooltip="ET WEB_SERVER WEB-PHP phpinfo access"]
"INFO DISCOVERY
http" [shape=oval]
"INFO DISCOVERY
http" [tooltip="GPL WEB_SERVER globals.pl access"]
"HOST DISCOVERY
ms-wbt-server" [shape=oval]
"HOST DISCOVERY
ms-wbt-server" [tooltip="ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound)"]
"SERVICE DISCOVERY
rpas-c2" [shape=oval]
"SERVICE DISCOVERY
rpas-c2" [tooltip="ET SCAN Potential VNC Scan 5800-5820
ET SCAN Potential VNC Scan 5900-5920"]
"HOST DISCOVERY
http" [shape=oval]
"HOST DISCOVERY
http" [tooltip="ET SCAN Possible Nmap User-Agent Observed
ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)"]
"ARBITRARY CODE EXECUTION
http | ID: 32" [shape=box]
"ARBITRARY CODE EXECUTION
http | ID: 32" [tooltip="ET CURRENT_EVENTS QNAP Shellshock CVE-2014-6271"]
}
